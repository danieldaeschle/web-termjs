{"version":3,"sources":["webpack:///webpack/universalModuleDefinition","webpack:///terminal.min.js","webpack:///webpack/bootstrap f5ec34e571d52d63cdec","webpack:///./src/terminal.ts","webpack:///./src/stream.ts"],"names":["root","factory","exports","module","define","amd","this","modules","__webpack_require__","moduleId","installedModules","i","l","call","m","c","d","name","getter","o","Object","defineProperty","configurable","enumerable","get","n","__esModule","object","property","prototype","hasOwnProperty","p","s","value","stream_1","Terminal","container","exec","options","welcome","prompt","separator","theme","histtemp","console","log","Storage","history","window","localStorage","getItem","JSON","parse","histpos","length","setupTerminal","_this","classList","add","insertAdjacentHTML","termContainer","querySelector","inputLine","cmdLine","output","background","document","addEventListener","e","setTimeout","scrollIntoView","write","focus","stopPropagation","terminal","inputTextClick","historyHandler","processNewCommand","preventDefault","self","node","keyCode","cmdline","setItem","stringify","line","parentNode","cloneNode","removeAttribute","input","autofocus","readOnly","removeChild","appendChild","args","trim","split","filter","val","cmd","splice","stream","Stream","onClose","remove","onWrite","html","clear","innerHTML","style","minHeight","setTheme","getTheme","setPrompt","getPromt","replace","RegExp","closed","_write","close","_close","callback"],"mappings":"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","file":"terminal.min.js","sourcesContent":["(function webpackUniversalModuleDefinition(root, factory) {\n\tif(typeof exports === 'object' && typeof module === 'object')\n\t\tmodule.exports = factory();\n\telse if(typeof define === 'function' && define.amd)\n\t\tdefine(\"terminal\", [], factory);\n\telse if(typeof exports === 'object')\n\t\texports[\"terminal\"] = factory();\n\telse\n\t\troot[\"terminal\"] = factory();\n})(this, function() {\nreturn \n\n\n// WEBPACK FOOTER //\n// webpack/universalModuleDefinition","(function webpackUniversalModuleDefinition(root, factory) {\n\tif(typeof exports === 'object' && typeof module === 'object')\n\t\tmodule.exports = factory();\n\telse if(typeof define === 'function' && define.amd)\n\t\tdefine(\"terminal\", [], factory);\n\telse if(typeof exports === 'object')\n\t\texports[\"terminal\"] = factory();\n\telse\n\t\troot[\"terminal\"] = factory();\n})(this, function() {\nreturn /******/ (function(modules) { // webpackBootstrap\n/******/ \t// The module cache\n/******/ \tvar installedModules = {};\n/******/\n/******/ \t// The require function\n/******/ \tfunction __webpack_require__(moduleId) {\n/******/\n/******/ \t\t// Check if module is in cache\n/******/ \t\tif(installedModules[moduleId]) {\n/******/ \t\t\treturn installedModules[moduleId].exports;\n/******/ \t\t}\n/******/ \t\t// Create a new module (and put it into the cache)\n/******/ \t\tvar module = installedModules[moduleId] = {\n/******/ \t\t\ti: moduleId,\n/******/ \t\t\tl: false,\n/******/ \t\t\texports: {}\n/******/ \t\t};\n/******/\n/******/ \t\t// Execute the module function\n/******/ \t\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n/******/\n/******/ \t\t// Flag the module as loaded\n/******/ \t\tmodule.l = true;\n/******/\n/******/ \t\t// Return the exports of the module\n/******/ \t\treturn module.exports;\n/******/ \t}\n/******/\n/******/\n/******/ \t// expose the modules object (__webpack_modules__)\n/******/ \t__webpack_require__.m = modules;\n/******/\n/******/ \t// expose the module cache\n/******/ \t__webpack_require__.c = installedModules;\n/******/\n/******/ \t// define getter function for harmony exports\n/******/ \t__webpack_require__.d = function(exports, name, getter) {\n/******/ \t\tif(!__webpack_require__.o(exports, name)) {\n/******/ \t\t\tObject.defineProperty(exports, name, {\n/******/ \t\t\t\tconfigurable: false,\n/******/ \t\t\t\tenumerable: true,\n/******/ \t\t\t\tget: getter\n/******/ \t\t\t});\n/******/ \t\t}\n/******/ \t};\n/******/\n/******/ \t// getDefaultExport function for compatibility with non-harmony modules\n/******/ \t__webpack_require__.n = function(module) {\n/******/ \t\tvar getter = module && module.__esModule ?\n/******/ \t\t\tfunction getDefault() { return module['default']; } :\n/******/ \t\t\tfunction getModuleExports() { return module; };\n/******/ \t\t__webpack_require__.d(getter, 'a', getter);\n/******/ \t\treturn getter;\n/******/ \t};\n/******/\n/******/ \t// Object.prototype.hasOwnProperty.call\n/******/ \t__webpack_require__.o = function(object, property) { return Object.prototype.hasOwnProperty.call(object, property); };\n/******/\n/******/ \t// __webpack_public_path__\n/******/ \t__webpack_require__.p = \"\";\n/******/\n/******/ \t// Load entry module and return exports\n/******/ \treturn __webpack_require__(__webpack_require__.s = 0);\n/******/ })\n/************************************************************************/\n/******/ ([\n/* 0 */\n/***/ (function(module, exports, __webpack_require__) {\n\n\"use strict\";\n\r\nObject.defineProperty(exports, \"__esModule\", { value: true });\r\nvar stream_1 = __webpack_require__(1);\r\nvar Terminal = /** @class */ (function () {\r\n    function Terminal(container, exec, options) {\r\n        if (options === void 0) { options = {\r\n            welcome: '',\r\n            prompt: '',\r\n            separator: '$',\r\n            theme: 'dark'\r\n        }; }\r\n        this.container = container;\r\n        this.exec = exec;\r\n        this.options = options;\r\n        this.histtemp = '';\r\n        console.log(Storage);\r\n        this.history = window.localStorage.getItem('history') ? JSON.parse(window.localStorage.getItem('history')) : [];\r\n        this.histpos = this.history.length;\r\n        this.setupTerminal();\r\n    }\r\n    Terminal.prototype.setupTerminal = function () {\r\n        var _this = this;\r\n        this.container.classList.add('terminal');\r\n        this.container.classList.add(\"terminal-\" + this.options.theme);\r\n        this.container.insertAdjacentHTML('beforeend', \"\\n            <div class=\\\"background\\\">\\n                <div class=\\\"interlace\\\"></div>\\n            </div>\\n            <div class=\\\"term-container\\\">\\n                <output></output>\\n                <table class=\\\"input-line\\\">\\n                    <tr>\\n                        <td nowrap>\\n                            <div class=\\\"prompt\\\">\" + this.options.prompt + this.options.separator + \"</div>\\n                        </td>\\n                        <td width=\\\"100%\\\">\\n                            <input class=\\\"cmdline\\\" autofocus spellcheck=\\\"false\\\" />\\n                        </td>\\n                    </tr>\\n                </table>\\n            </div>\\n        \");\r\n        this.termContainer = this.container.querySelector('.term-container');\r\n        this.inputLine = this.termContainer.querySelector('.input-line');\r\n        this.cmdLine = this.termContainer.querySelector('.input-line .cmdline');\r\n        this.output = this.termContainer.querySelector('output');\r\n        this.prompt = this.termContainer.querySelector('.prompt');\r\n        this.background = document.querySelector('.background');\r\n        this.output.addEventListener('DOMSubtreeModified', function (e) {\r\n            setTimeout(function () {\r\n                _this.cmdLine.scrollIntoView();\r\n            }, 0);\r\n        });\r\n        if (this.options.welcome) {\r\n            this.write(this.options.welcome);\r\n        }\r\n        window.addEventListener('click', function (e) {\r\n            _this.cmdLine.focus();\r\n        }, false);\r\n        this.output.addEventListener('click', function (e) {\r\n            e.stopPropagation();\r\n        }, false);\r\n        var terminal = this;\r\n        this.cmdLine.addEventListener('click', function (e) {\r\n            terminal.inputTextClick(e, this);\r\n        }, false);\r\n        this.inputLine.addEventListener('click', function (e) {\r\n            _this.cmdLine.focus();\r\n        }, false);\r\n        this.cmdLine.addEventListener('keyup', function (e) {\r\n            terminal.historyHandler(e, this);\r\n        }, false);\r\n        this.cmdLine.addEventListener('keydown', function (e) {\r\n            terminal.processNewCommand(terminal, e, this);\r\n        }, false);\r\n        window.addEventListener('keyup', function (e) {\r\n            _this.cmdLine.focus();\r\n            e.stopPropagation();\r\n            e.preventDefault();\r\n        }, false);\r\n    };\r\n    Terminal.prototype.processNewCommand = function (self, e, node) {\r\n        var _this = this;\r\n        // Only handle the Enter key.\r\n        if (e.keyCode !== 13)\r\n            return;\r\n        var cmdline = node.value;\r\n        // Save shell history.\r\n        if (cmdline) {\r\n            this.history[this.history.length] = cmdline;\r\n            window.localStorage.setItem('history', JSON.stringify(this.history));\r\n            this.histpos = this.history.length;\r\n        }\r\n        // Duplicate current input and append to output section.\r\n        var line = node.parentNode.parentNode.parentNode.parentNode.cloneNode(true);\r\n        line.removeAttribute('id');\r\n        line.classList.add('line');\r\n        var input = line.querySelector('input.cmdline');\r\n        input.autofocus = false;\r\n        input.readOnly = true;\r\n        input.insertAdjacentHTML('beforebegin', input.value);\r\n        input.parentNode.removeChild(input);\r\n        this.output.appendChild(line);\r\n        // Hide command line until we're done processing input.\r\n        this.inputLine.classList.add('hidden');\r\n        // Clear/setup line for next input.\r\n        node.value = '';\r\n        // Parse out command, args, and trim off whitespace.\r\n        var args;\r\n        if (cmdline && cmdline.trim()) {\r\n            args = cmdline.split(' ').filter(function (val, i) {\r\n                return val;\r\n            });\r\n            var cmd = args[0];\r\n            args = args.splice(1); // Remove cmd from arg list.\r\n        }\r\n        if (cmd) {\r\n            var stream = new stream_1.Stream()\r\n                .onClose(function () {\r\n                _this.inputLine.classList.remove('hidden');\r\n            })\r\n                .onWrite(function (html) {\r\n                _this.write(html);\r\n            });\r\n            this.exec(cmd, args, stream);\r\n        }\r\n    };\r\n    Terminal.prototype.inputTextClick = function (e, node) {\r\n        node.value = node.value;\r\n    };\r\n    Terminal.prototype.historyHandler = function (e, node) {\r\n        // Clear command-line on Escape key.\r\n        if (e.keyCode === 27) {\r\n            node.value = '';\r\n            e.stopPropagation();\r\n            e.preventDefault();\r\n        }\r\n        if (this.history.length && (e.keyCode === 38 || e.keyCode === 40)) {\r\n            if (this.history[this.histpos]) {\r\n                this.history[this.histpos] = node.value;\r\n            }\r\n            else {\r\n                this.histtemp = node.value;\r\n            }\r\n            if (e.keyCode == 38) {\r\n                // Up arrow key.\r\n                this.histpos--;\r\n                if (this.histpos < 0) {\r\n                    this.histpos = 0;\r\n                }\r\n            }\r\n            else if (e.keyCode == 40) {\r\n                // Down arrow key.\r\n                this.histpos++;\r\n                if (this.histpos > this.history.length) {\r\n                    this.histpos = this.history.length;\r\n                }\r\n            }\r\n            node.value = this.history[this.histpos] ? this.history[this.histpos] : this.histtemp;\r\n            // Move cursor to end of input.\r\n            node.value = node.value;\r\n        }\r\n    };\r\n    Terminal.prototype.write = function (html) {\r\n        this.output.insertAdjacentHTML('beforeend', html);\r\n        this.cmdLine.scrollIntoView();\r\n    };\r\n    Terminal.prototype.clear = function (node) {\r\n        this.output.innerHTML = '';\r\n        this.cmdLine.value = '';\r\n        this.background.style.minHeight = '';\r\n    };\r\n    Terminal.prototype.setTheme = function (theme) {\r\n        this.container.classList.remove(\"terminal-\" + this.options.theme);\r\n        this.options.theme = theme;\r\n        this.container.classList.add(\"terminal-\" + this.options.theme);\r\n    };\r\n    Terminal.prototype.getTheme = function () {\r\n        return this.options.theme;\r\n    };\r\n    Terminal.prototype.setPrompt = function (prompt) {\r\n        this.prompt.innerHTML = prompt + this.options.separator;\r\n    };\r\n    Terminal.prototype.getPromt = function () {\r\n        return this.prompt.innerHTML.replace(new RegExp(this.options.separator + '$'), '');\r\n    };\r\n    return Terminal;\r\n}());\r\nexports.Terminal = Terminal;\r\n\n\n/***/ }),\n/* 1 */\n/***/ (function(module, exports, __webpack_require__) {\n\n\"use strict\";\n\r\nObject.defineProperty(exports, \"__esModule\", { value: true });\r\nvar Stream = /** @class */ (function () {\r\n    function Stream() {\r\n        this.closed = false;\r\n    }\r\n    Stream.prototype.write = function (html) {\r\n        if (this.closed)\r\n            return;\r\n        this._write(html);\r\n    };\r\n    Stream.prototype.close = function () {\r\n        this._close();\r\n        this.closed = true;\r\n    };\r\n    Stream.prototype.onWrite = function (callback) {\r\n        this._write = callback;\r\n        return this;\r\n    };\r\n    Stream.prototype.onClose = function (callback) {\r\n        this._close = callback;\r\n        return this;\r\n    };\r\n    return Stream;\r\n}());\r\nexports.Stream = Stream;\r\n\n\n/***/ })\n/******/ ]);\n});\n\n\n// WEBPACK FOOTER //\n// terminal.min.js"," \t// The module cache\n \tvar installedModules = {};\n\n \t// The require function\n \tfunction __webpack_require__(moduleId) {\n\n \t\t// Check if module is in cache\n \t\tif(installedModules[moduleId]) {\n \t\t\treturn installedModules[moduleId].exports;\n \t\t}\n \t\t// Create a new module (and put it into the cache)\n \t\tvar module = installedModules[moduleId] = {\n \t\t\ti: moduleId,\n \t\t\tl: false,\n \t\t\texports: {}\n \t\t};\n\n \t\t// Execute the module function\n \t\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n \t\t// Flag the module as loaded\n \t\tmodule.l = true;\n\n \t\t// Return the exports of the module\n \t\treturn module.exports;\n \t}\n\n\n \t// expose the modules object (__webpack_modules__)\n \t__webpack_require__.m = modules;\n\n \t// expose the module cache\n \t__webpack_require__.c = installedModules;\n\n \t// define getter function for harmony exports\n \t__webpack_require__.d = function(exports, name, getter) {\n \t\tif(!__webpack_require__.o(exports, name)) {\n \t\t\tObject.defineProperty(exports, name, {\n \t\t\t\tconfigurable: false,\n \t\t\t\tenumerable: true,\n \t\t\t\tget: getter\n \t\t\t});\n \t\t}\n \t};\n\n \t// getDefaultExport function for compatibility with non-harmony modules\n \t__webpack_require__.n = function(module) {\n \t\tvar getter = module && module.__esModule ?\n \t\t\tfunction getDefault() { return module['default']; } :\n \t\t\tfunction getModuleExports() { return module; };\n \t\t__webpack_require__.d(getter, 'a', getter);\n \t\treturn getter;\n \t};\n\n \t// Object.prototype.hasOwnProperty.call\n \t__webpack_require__.o = function(object, property) { return Object.prototype.hasOwnProperty.call(object, property); };\n\n \t// __webpack_public_path__\n \t__webpack_require__.p = \"\";\n\n \t// Load entry module and return exports\n \treturn __webpack_require__(__webpack_require__.s = 0);\n\n\n\n// WEBPACK FOOTER //\n// webpack/bootstrap f5ec34e571d52d63cdec","import { Options } from './options';\r\nimport { Stream } from './stream';\r\n\r\nexport class Terminal {\r\n  private history: any[];\r\n  private histpos: number;\r\n  private histtemp = '';\r\n\r\n  private termContainer: HTMLElement;\r\n  private inputLine: HTMLElement;\r\n  private cmdLine: any;\r\n  private output: HTMLElement;\r\n  private prompt: HTMLElement;\r\n  private background: HTMLElement;\r\n\r\n  constructor(\r\n    private container: HTMLElement,\r\n    private exec: Function,\r\n    private options: Options = {\r\n      welcome: '',\r\n      prompt: '',\r\n      separator: '$',\r\n      theme: 'dark'\r\n  }) {\r\n    console.log(Storage);  \r\n    this.history = window.localStorage.getItem('history') ? JSON.parse(window.localStorage.getItem('history')) : [];\r\n    this.histpos = this.history.length;\r\n\r\n    this.setupTerminal();\r\n  }\r\n\r\n  private setupTerminal() {\r\n    this.container.classList.add('terminal');\r\n    this.container.classList.add(`terminal-${this.options.theme}`);\r\n    this.container.insertAdjacentHTML('beforeend', `\r\n            <div class=\"background\">\r\n                <div class=\"interlace\"></div>\r\n            </div>\r\n            <div class=\"term-container\">\r\n                <output></output>\r\n                <table class=\"input-line\">\r\n                    <tr>\r\n                        <td nowrap>\r\n                            <div class=\"prompt\">${this.options.prompt}${this.options.separator}</div>\r\n                        </td>\r\n                        <td width=\"100%\">\r\n                            <input class=\"cmdline\" autofocus spellcheck=\"false\" />\r\n                        </td>\r\n                    </tr>\r\n                </table>\r\n            </div>\r\n        `);\r\n\r\n    this.termContainer = this.container.querySelector('.term-container') as HTMLElement;\r\n    this.inputLine = this.termContainer.querySelector('.input-line') as HTMLElement;\r\n    this.cmdLine = this.termContainer.querySelector('.input-line .cmdline') as HTMLElement;\r\n    this.output = this.termContainer.querySelector('output') as HTMLElement;\r\n    this.prompt = this.termContainer.querySelector('.prompt') as HTMLElement;\r\n    this.background = document.querySelector('.background') as HTMLElement;\r\n\r\n    this.output.addEventListener('DOMSubtreeModified', (e) => {\r\n      setTimeout(() => {\r\n        this.cmdLine.scrollIntoView();\r\n      }, 0);\r\n    });\r\n\r\n    if (this.options.welcome) {\r\n      this.write(this.options.welcome);\r\n    }\r\n\r\n    window.addEventListener('click', (e) => {\r\n      this.cmdLine.focus();\r\n    }, false);\r\n\r\n    this.output.addEventListener('click', (e) => {\r\n      e.stopPropagation();\r\n    }, false);\r\n\r\n    const terminal = this;\r\n\r\n    this.cmdLine.addEventListener('click', function(e) {\r\n      terminal.inputTextClick(e, this);\r\n    }, false);\r\n\r\n    this.inputLine.addEventListener('click', (e) => {\r\n      this.cmdLine.focus();\r\n    }, false);\r\n\r\n    this.cmdLine.addEventListener('keyup', function(e) {\r\n      terminal.historyHandler(e, this)\r\n    }, false);\r\n\r\n    this.cmdLine.addEventListener('keydown', function(e) {\r\n      terminal.processNewCommand(terminal, e, this)\r\n    }, false);\r\n\r\n    window.addEventListener('keyup', (e) => {\r\n      this.cmdLine.focus();\r\n      e.stopPropagation();\r\n      e.preventDefault();\r\n    }, false);\r\n  }\r\n\r\n  private processNewCommand(self: Terminal, e: any, node: any) {\r\n    // Only handle the Enter key.\r\n    if (e.keyCode !== 13) return;\r\n\r\n    const cmdline = node.value;\r\n\r\n    // Save shell history.\r\n    if (cmdline) {\r\n      this.history[this.history.length] = cmdline;\r\n      window.localStorage.setItem('history', JSON.stringify(this.history));\r\n      this.histpos = this.history.length;\r\n    }\r\n\r\n    // Duplicate current input and append to output section.\r\n    const line = node.parentNode.parentNode.parentNode.parentNode.cloneNode(true);\r\n    line.removeAttribute('id')\r\n    line.classList.add('line');\r\n\r\n    const input = line.querySelector('input.cmdline');\r\n    input.autofocus = false;\r\n    input.readOnly = true;\r\n    input.insertAdjacentHTML('beforebegin', input.value);\r\n    input.parentNode.removeChild(input);\r\n    this.output.appendChild(line);\r\n\r\n    // Hide command line until we're done processing input.\r\n    this.inputLine.classList.add('hidden');\r\n\r\n    // Clear/setup line for next input.\r\n    node.value = '';\r\n\r\n    // Parse out command, args, and trim off whitespace.\r\n    let args;\r\n    if (cmdline && cmdline.trim()) {\r\n      args = cmdline.split(' ').filter(function (val, i) {\r\n        return val;\r\n      });\r\n      var cmd = args[0];\r\n      args = args.splice(1); // Remove cmd from arg list.\r\n    }\r\n\r\n    if (cmd) {\r\n      const stream = new Stream()\r\n        .onClose(() => {\r\n          this.inputLine.classList.remove('hidden');\r\n        })\r\n        .onWrite((html: string) => {\r\n          this.write(html);\r\n        });\r\n      \r\n      this.exec(cmd, args, stream);\r\n    }\r\n  }\r\n\r\n  private inputTextClick(e: any, node) {\r\n    node.value = node.value;\r\n  }\r\n\r\n  private historyHandler(e, node) {\r\n    // Clear command-line on Escape key.\r\n    if (e.keyCode === 27) {\r\n      node.value = '';\r\n      e.stopPropagation();\r\n      e.preventDefault();\r\n    }\r\n\r\n    if (this.history.length && (e.keyCode === 38 || e.keyCode === 40)) {\r\n      if (this.history[this.histpos]) {\r\n        this.history[this.histpos] = node.value;\r\n      }\r\n      else {\r\n        this.histtemp = node.value;\r\n      }\r\n\r\n      if (e.keyCode == 38) {\r\n        // Up arrow key.\r\n        this.histpos--;\r\n        if (this.histpos < 0) {\r\n          this.histpos = 0;\r\n        }\r\n      }\r\n      else if (e.keyCode == 40) {\r\n        // Down arrow key.\r\n        this.histpos++;\r\n        if (this.histpos > this.history.length) {\r\n          this.histpos = this.history.length;\r\n        }\r\n      }\r\n\r\n      node.value = this.history[this.histpos] ? this.history[this.histpos] : this.histtemp;\r\n\r\n      // Move cursor to end of input.\r\n      node.value = node.value;\r\n    }\r\n  }\r\n\r\n  private write(html: string) {\r\n    this.output.insertAdjacentHTML('beforeend', html);\r\n    this.cmdLine.scrollIntoView();\r\n  }\r\n\r\n  clear(node) {\r\n    this.output.innerHTML = '';\r\n    this.cmdLine.value = '';\r\n    this.background.style.minHeight = '';\r\n  }\r\n\r\n  setTheme(theme) {\r\n    this.container.classList.remove(`terminal-${this.options.theme}`);\r\n    this.options.theme = theme;\r\n    this.container.classList.add(`terminal-${this.options.theme}`);\r\n  }\r\n\r\n  getTheme(): string {\r\n    return this.options.theme;\r\n  }\r\n\r\n  setPrompt(prompt) {\r\n    this.prompt.innerHTML = prompt + this.options.separator;\r\n  }\r\n\r\n  getPromt(): string {\r\n    return this.prompt.innerHTML.replace(new RegExp(this.options.separator + '$'), '');\r\n  }\r\n}\r\n\n\n\n// WEBPACK FOOTER //\n// ./src/terminal.ts","export class Stream {\r\n    private closed: boolean = false;\r\n    private _write: (html: string) => any;\r\n    private _close: () => any;\r\n\r\n    write(html: string) {\r\n        if (this.closed) return;\r\n        this._write(html)\r\n    }\r\n\r\n    close() {\r\n        this._close();\r\n        this.closed = true;\r\n    }\r\n\r\n    onWrite(callback: (html: string) => any): Stream {\r\n        this._write = callback;\r\n        return this;\r\n    }\r\n\r\n    onClose(callback: () => any): Stream {\r\n        this._close = callback;\r\n        return this;\r\n    }\r\n}\r\n\n\n\n// WEBPACK FOOTER //\n// ./src/stream.ts"],"sourceRoot":""}